services:
  chain-bootstrap:
    image: ghcr.io/foundry-rs/foundry:latest
    restart: no
    user: root
    command: ./bootstrap.sh
    env_file:
      - bootstrap.env
    volumes:
      - ./bootstrap.sh:/bootstrap.sh
    networks:
      - custodial      
  eth-tracker-cache-bootstrap:
    image: ghcr.io/grassrootseconomics/eth-tracker:v1.2.2-rc
    restart: no
    env_file:
      - bootstrap.env
    depends_on:
      chain-bootstrap:
        condition: service_completed_successfully    
    command:
      - /bin/bash
      - -c
      - |
        /service/eth-tracker-cache-bootstrap
    networks:
      - custodial
  eth-indexer-bootstrap:
    image: ghcr.io/grassrootseconomics/eth-indexer:v1.4.2-beta
    restart: no
    env_file:
      - bootstrap.env
    depends_on:
      chain-bootstrap:
        condition: service_completed_successfully    
    command:
      - /bin/bash
      - -c
      - |
        /service/eth-indexer-bootstrap
    networks:
      - custodial      

networks:
  custodial:
    external: true  